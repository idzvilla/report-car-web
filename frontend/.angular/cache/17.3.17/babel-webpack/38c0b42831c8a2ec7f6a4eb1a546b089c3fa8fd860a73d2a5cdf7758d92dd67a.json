{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/auth.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nfunction NavbarComponent_ng_container_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function NavbarComponent_ng_container_8_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.goToLogin());\n    });\n    i0.ɵɵtext(2, \"\\u0412\\u043E\\u0439\\u0442\\u0438\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function NavbarComponent_ng_container_8_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.goToRegister());\n    });\n    i0.ɵɵtext(4, \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"div\", 11);\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction NavbarComponent_ng_template_9_img_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 19);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"src\", ctx_r1.currentUser == null ? null : ctx_r1.currentUser.photoUrl, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r1.currentUser == null ? null : ctx_r1.currentUser.fullName);\n  }\n}\nfunction NavbarComponent_ng_template_9_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 20);\n    i0.ɵɵtext(1, \" Telegram \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction NavbarComponent_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 12);\n    i0.ɵɵtemplate(2, NavbarComponent_ng_template_9_img_2_Template, 1, 2, \"img\", 13);\n    i0.ɵɵelementStart(3, \"span\", 14);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, NavbarComponent_ng_template_9_span_5_Template, 2, 0, \"span\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"a\", 16);\n    i0.ɵɵtext(7, \" \\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"a\", 17);\n    i0.ɵɵtext(9, \" \\u0410\\u0434\\u043C\\u0438\\u043D \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function NavbarComponent_ng_template_9_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.logout());\n    });\n    i0.ɵɵtext(11, \" \\u0412\\u044B\\u0439\\u0442\\u0438 \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.currentUser == null ? null : ctx_r1.currentUser.photoUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \\u041F\\u0440\\u0438\\u0432\\u0435\\u0442, \", (ctx_r1.currentUser == null ? null : ctx_r1.currentUser.fullName) || (ctx_r1.currentUser == null ? null : ctx_r1.currentUser.email), \"! \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (ctx_r1.currentUser == null ? null : ctx_r1.currentUser.authProvider) === \"telegram\");\n  }\n}\nexport class NavbarComponent {\n  constructor(authService, router) {\n    this.authService = authService;\n    this.router = router;\n    this.currentUser = null;\n    this.isAuthenticated = false;\n  }\n  ngOnInit() {\n    this.authService.currentUser$.subscribe(user => {\n      this.currentUser = user;\n      this.isAuthenticated = !!user;\n    });\n  }\n  goToLogin() {\n    this.router.navigate(['/login']);\n  }\n  goToRegister() {\n    this.router.navigate(['/register']);\n  }\n  logout() {\n    this.authService.logout().subscribe({\n      next: () => {\n        this.router.navigate(['/']);\n      },\n      error: error => {\n        console.error('Ошибка выхода:', error);\n        // Всё равно перенаправляем на главную\n        this.router.navigate(['/']);\n      }\n    });\n  }\n  static {\n    this.ɵfac = function NavbarComponent_Factory(t) {\n      return new (t || NavbarComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.Router));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: NavbarComponent,\n      selectors: [[\"app-navbar\"]],\n      decls: 11,\n      vars: 2,\n      consts: [[\"authenticatedMenu\", \"\"], [1, \"bg-white\", \"border-b\", \"border-gray-200\"], [1, \"max-w-7xl\", \"mx-auto\", \"px-4\", \"sm:px-6\", \"lg:px-8\"], [1, \"flex\", \"justify-between\", \"items-center\", \"h-16\"], [1, \"flex\", \"items-center\"], [\"routerLink\", \"/\", 1, \"flex-shrink-0\", \"flex\", \"items-center\"], [1, \"text-2xl\", \"font-bold\", \"text-gray-900\"], [1, \"flex\", \"items-center\", \"space-x-4\"], [4, \"ngIf\", \"ngIfElse\"], [1, \"btn\", \"btn-outline\", 3, \"click\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"telegram-login-widget\"], [1, \"flex\", \"items-center\", \"space-x-2\"], [\"class\", \"w-8 h-8 rounded-full\", 3, \"src\", \"alt\", 4, \"ngIf\"], [1, \"text-sm\", \"text-gray-700\"], [\"class\", \"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full\", 4, \"ngIf\"], [\"routerLink\", \"/profile\", 1, \"btn\", \"btn-outline\", \"btn-sm\"], [\"routerLink\", \"/admin\", 1, \"btn\", \"btn-outline\", \"btn-sm\"], [1, \"btn\", \"btn-outline\", \"btn-sm\", 3, \"click\"], [1, \"w-8\", \"h-8\", \"rounded-full\", 3, \"src\", \"alt\"], [1, \"text-xs\", \"text-blue-600\", \"bg-blue-50\", \"px-2\", \"py-1\", \"rounded-full\"]],\n      template: function NavbarComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"nav\", 1)(1, \"div\", 2)(2, \"div\", 3)(3, \"div\", 4)(4, \"a\", 5)(5, \"h1\", 6);\n          i0.ɵɵtext(6, \"CarFax Web\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(7, \"div\", 7);\n          i0.ɵɵtemplate(8, NavbarComponent_ng_container_8_Template, 6, 0, \"ng-container\", 8)(9, NavbarComponent_ng_template_9_Template, 12, 3, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          const authenticatedMenu_r4 = i0.ɵɵreference(10);\n          i0.ɵɵadvance(8);\n          i0.ɵɵproperty(\"ngIf\", !ctx.isAuthenticated)(\"ngIfElse\", authenticatedMenu_r4);\n        }\n      },\n      dependencies: [i3.NgIf, i2.RouterLink],\n      encapsulation: 2\n    });\n  }\n}","map":{"version":3,"names":["i0","ɵɵelementContainerStart","ɵɵelementStart","ɵɵlistener","NavbarComponent_ng_container_8_Template_button_click_1_listener","ɵɵrestoreView","_r1","ctx_r1","ɵɵnextContext","ɵɵresetView","goToLogin","ɵɵtext","ɵɵelementEnd","NavbarComponent_ng_container_8_Template_button_click_3_listener","goToRegister","ɵɵelement","ɵɵproperty","currentUser","photoUrl","ɵɵsanitizeUrl","fullName","ɵɵtemplate","NavbarComponent_ng_template_9_img_2_Template","NavbarComponent_ng_template_9_span_5_Template","NavbarComponent_ng_template_9_Template_button_click_10_listener","_r3","logout","ɵɵadvance","ɵɵtextInterpolate1","email","authProvider","NavbarComponent","constructor","authService","router","isAuthenticated","ngOnInit","currentUser$","subscribe","user","navigate","next","error","console","ɵɵdirectiveInject","i1","AuthService","i2","Router","selectors","decls","vars","consts","template","NavbarComponent_Template","rf","ctx","NavbarComponent_ng_container_8_Template","NavbarComponent_ng_template_9_Template","ɵɵtemplateRefExtractor","authenticatedMenu_r4"],"sources":["/Users/test/Documents/Apps/CarFax Web/frontend/src/app/components/navbar/navbar.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AuthService, User } from '../../services/auth.service';\n\n@Component({\n  selector: 'app-navbar',\n  template: `\n    <nav class=\"bg-white border-b border-gray-200\">\n      <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div class=\"flex justify-between items-center h-16\">\n          <div class=\"flex items-center\">\n            <a routerLink=\"/\" class=\"flex-shrink-0 flex items-center\">\n              <h1 class=\"text-2xl font-bold text-gray-900\">CarFax Web</h1>\n            </a>\n          </div>\n          \n          <div class=\"flex items-center space-x-4\">\n            <ng-container *ngIf=\"!isAuthenticated; else authenticatedMenu\">\n              <button (click)=\"goToLogin()\" class=\"btn btn-outline\">Войти</button>\n              <button (click)=\"goToRegister()\" class=\"btn btn-primary\">Регистрация</button>\n              <div class=\"telegram-login-widget\">\n                <script async src=\"https://telegram.org/js/telegram-widget.js?7\"\n                        data-telegram-login=\"carfax_web_bot\"\n                        data-size=\"medium\"\n                        data-auth-url=\"http://localhost:3000/api/auth/telegram\"\n                        data-request-access=\"write\"></script>\n              </div>\n            </ng-container>\n            \n            <ng-template #authenticatedMenu>\n              <div class=\"flex items-center space-x-4\">\n                <div class=\"flex items-center space-x-2\">\n                  <img *ngIf=\"currentUser?.photoUrl\" \n                       [src]=\"currentUser?.photoUrl\" \n                       [alt]=\"currentUser?.fullName\"\n                       class=\"w-8 h-8 rounded-full\">\n                  <span class=\"text-sm text-gray-700\">\n                    Привет, {{ currentUser?.fullName || currentUser?.email }}!\n                  </span>\n                  <span *ngIf=\"currentUser?.authProvider === 'telegram'\" \n                        class=\"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full\">\n                    Telegram\n                  </span>\n                </div>\n                <a routerLink=\"/profile\" class=\"btn btn-outline btn-sm\">\n                  Профиль\n                </a>\n                <a routerLink=\"/admin\" class=\"btn btn-outline btn-sm\">\n                  Админ\n                </a>\n                <button (click)=\"logout()\" class=\"btn btn-outline btn-sm\">\n                  Выйти\n                </button>\n              </div>\n            </ng-template>\n          </div>\n        </div>\n      </div>\n    </nav>\n  `,\n  styles: []\n})\nexport class NavbarComponent implements OnInit {\n  currentUser: User | null = null;\n  isAuthenticated = false;\n\n  constructor(\n    private authService: AuthService,\n    private router: Router\n  ) {}\n\n  ngOnInit(): void {\n    this.authService.currentUser$.subscribe(user => {\n      this.currentUser = user;\n      this.isAuthenticated = !!user;\n    });\n  }\n\n  goToLogin(): void {\n    this.router.navigate(['/login']);\n  }\n\n  goToRegister(): void {\n    this.router.navigate(['/register']);\n  }\n\n  logout(): void {\n    this.authService.logout().subscribe({\n      next: () => {\n        this.router.navigate(['/']);\n      },\n      error: (error) => {\n        console.error('Ошибка выхода:', error);\n        // Всё равно перенаправляем на главную\n        this.router.navigate(['/']);\n      }\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}