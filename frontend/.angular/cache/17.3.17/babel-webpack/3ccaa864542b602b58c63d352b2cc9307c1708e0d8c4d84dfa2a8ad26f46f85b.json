{"ast":null,"code":"import _asyncToGenerator from \"/Users/test/Documents/Apps/CarFax Web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/common\";\nfunction VinInputComponent_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function VinInputComponent_button_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.pasteFromClipboard());\n    });\n    i0.ɵɵtext(1, \" \\u0412\\u0441\\u0442\\u0430\\u0432\\u0438\\u0442\\u044C \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VinInputComponent_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function VinInputComponent_button_9_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.clearInput());\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(1, \"svg\", 16);\n    i0.ɵɵelement(2, \"path\", 17);\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction VinInputComponent_div_10_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" VIN \\u043D\\u043E\\u043C\\u0435\\u0440 \\u043E\\u0431\\u044F\\u0437\\u0430\\u0442\\u0435\\u043B\\u0435\\u043D \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VinInputComponent_div_10_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" VIN \\u0434\\u043E\\u043B\\u0436\\u0435\\u043D \\u0441\\u043E\\u0434\\u0435\\u0440\\u0436\\u0430\\u0442\\u044C \\u0440\\u043E\\u0432\\u043D\\u043E 17 \\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u043E\\u0432 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VinInputComponent_div_10_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" VIN \\u0441\\u043E\\u0434\\u0435\\u0440\\u0436\\u0438\\u0442 \\u043D\\u0435\\u0434\\u043E\\u043F\\u0443\\u0441\\u0442\\u0438\\u043C\\u044B\\u0435 \\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u044B \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VinInputComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtemplate(1, VinInputComponent_div_10_div_1_Template, 2, 0, \"div\", 12)(2, VinInputComponent_div_10_div_2_Template, 2, 0, \"div\", 12)(3, VinInputComponent_div_10_div_3_Template, 2, 0, \"div\", 12);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_1_0;\n    let tmp_2_0;\n    let tmp_3_0;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_1_0 = ctx_r1.vinForm.get(\"vin\")) == null ? null : tmp_1_0.errors == null ? null : tmp_1_0.errors[\"required\"]);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_2_0 = ctx_r1.vinForm.get(\"vin\")) == null ? null : tmp_2_0.errors == null ? null : tmp_2_0.errors[\"minlength\"]) || ((tmp_2_0 = ctx_r1.vinForm.get(\"vin\")) == null ? null : tmp_2_0.errors == null ? null : tmp_2_0.errors[\"maxlength\"]));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_3_0 = ctx_r1.vinForm.get(\"vin\")) == null ? null : tmp_3_0.errors == null ? null : tmp_3_0.errors[\"pattern\"]);\n  }\n}\nfunction VinInputComponent_span_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"\\u041F\\u043E\\u043B\\u0443\\u0447\\u0438\\u0442\\u044C \\u043E\\u0442\\u0447\\u0451\\u0442 CarFax\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VinInputComponent_span_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 19);\n    i0.ɵɵelement(1, \"div\", 20);\n    i0.ɵɵtext(2, \" \\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430... \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let VinInputComponent = /*#__PURE__*/(() => {\n  class VinInputComponent {\n    constructor(fb) {\n      this.fb = fb;\n      this.vinSubmitted = new EventEmitter();\n      this.isLoading = false;\n      this.hasValue = false;\n      this.vinForm = this.fb.group({\n        vin: ['', [Validators.required, Validators.minLength(17), Validators.maxLength(17), Validators.pattern(/^[A-HJ-NPR-Z0-9]{17}$/)]]\n      });\n      // Отслеживаем изменения в поле VIN\n      this.vinForm.get('vin')?.valueChanges.subscribe(value => {\n        this.hasValue = !!value && value.length > 0;\n      });\n    }\n    onVinInput(event) {\n      const value = event.target.value.toUpperCase();\n      event.target.value = value;\n      this.vinForm.patchValue({\n        vin: value\n      });\n    }\n    onSubmit() {\n      if (this.vinForm.valid) {\n        this.isLoading = true;\n        const vin = this.vinForm.get('vin')?.value;\n        this.vinSubmitted.emit(vin);\n      }\n    }\n    setLoading(loading) {\n      this.isLoading = loading;\n    }\n    resetForm() {\n      this.vinForm.reset();\n      this.isLoading = false;\n    }\n    pasteFromClipboard() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        try {\n          const text = yield navigator.clipboard.readText();\n          if (text) {\n            // Очищаем текст от лишних символов и приводим к верхнему регистру\n            const cleanText = text.replace(/[^A-HJ-NPR-Z0-9]/g, '').toUpperCase();\n            if (cleanText.length > 0) {\n              _this.vinForm.patchValue({\n                vin: cleanText\n              });\n            }\n          }\n        } catch (err) {\n          console.error('Ошибка при чтении буфера обмена:', err);\n          // Fallback для старых браузеров\n          const textArea = document.createElement('textarea');\n          textArea.value = '';\n          document.body.appendChild(textArea);\n          textArea.focus();\n          textArea.select();\n          try {\n            document.execCommand('paste');\n            const text = textArea.value.replace(/[^A-HJ-NPR-Z0-9]/g, '').toUpperCase();\n            if (text.length > 0) {\n              _this.vinForm.patchValue({\n                vin: text\n              });\n            }\n          } catch (fallbackErr) {\n            console.error('Fallback paste failed:', fallbackErr);\n          }\n          document.body.removeChild(textArea);\n        }\n      })();\n    }\n    clearInput() {\n      this.vinForm.patchValue({\n        vin: ''\n      });\n    }\n    static {\n      this.ɵfac = function VinInputComponent_Factory(t) {\n        return new (t || VinInputComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: VinInputComponent,\n        selectors: [[\"app-vin-input\"]],\n        outputs: {\n          vinSubmitted: \"vinSubmitted\"\n        },\n        decls: 15,\n        vars: 7,\n        consts: [[1, \"w-full\"], [3, \"ngSubmit\", \"formGroup\"], [1, \"form-group\", \"mb-4\"], [\"for\", \"vin\", 1, \"block\", \"text-lg\", \"font-medium\", \"text-gray-900\", \"mb-3\"], [1, \"relative\"], [\"id\", \"vin\", \"type\", \"text\", \"formControlName\", \"vin\", \"placeholder\", \"1HGBH41JXMN109186\", \"maxlength\", \"17\", 1, \"form-input\", \"vin-input\", \"h-12\", \"text-lg\", \"pr-20\", 3, \"input\"], [1, \"absolute\", \"inset-y-0\", \"right-0\", \"flex\", \"items-center\", \"pr-3\"], [\"type\", \"button\", \"class\", \"text-sm text-primary-600 hover:text-primary-700 font-medium px-2 py-1 rounded transition-colors\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", \"class\", \"text-gray-400 hover:text-gray-600 transition-colors p-1\", \"title\", \"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u0435\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"mt-2 text-sm text-danger\", 4, \"ngIf\"], [1, \"mt-4\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"h-12\", \"w-full\", \"text-base\", \"font-semibold\", 3, \"disabled\"], [4, \"ngIf\"], [\"class\", \"flex items-center justify-center\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"text-sm\", \"text-primary-600\", \"hover:text-primary-700\", \"font-medium\", \"px-2\", \"py-1\", \"rounded\", \"transition-colors\", 3, \"click\"], [\"type\", \"button\", \"title\", \"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u0435\", 1, \"text-gray-400\", \"hover:text-gray-600\", \"transition-colors\", \"p-1\", 3, \"click\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-4\", \"h-4\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M6 18L18 6M6 6l12 12\"], [1, \"mt-2\", \"text-sm\", \"text-danger\"], [1, \"flex\", \"items-center\", \"justify-center\"], [1, \"loading-spinner\", \"mr-2\"]],\n        template: function VinInputComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"form\", 1);\n            i0.ɵɵlistener(\"ngSubmit\", function VinInputComponent_Template_form_ngSubmit_1_listener() {\n              return ctx.onSubmit();\n            });\n            i0.ɵɵelementStart(2, \"div\", 2)(3, \"label\", 3);\n            i0.ɵɵtext(4, \" \\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 VIN \\u043D\\u043E\\u043C\\u0435\\u0440 \\u0434\\u043B\\u044F \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\\u0438\\u044F \\u043E\\u0442\\u0447\\u0451\\u0442\\u0430 CarFax \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"div\", 4)(6, \"input\", 5);\n            i0.ɵɵlistener(\"input\", function VinInputComponent_Template_input_input_6_listener($event) {\n              return ctx.onVinInput($event);\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"div\", 6);\n            i0.ɵɵtemplate(8, VinInputComponent_button_8_Template, 2, 0, \"button\", 7)(9, VinInputComponent_button_9_Template, 3, 0, \"button\", 8);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(10, VinInputComponent_div_10_Template, 4, 3, \"div\", 9);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(11, \"div\", 10)(12, \"button\", 11);\n            i0.ɵɵtemplate(13, VinInputComponent_span_13_Template, 2, 0, \"span\", 12)(14, VinInputComponent_span_14_Template, 3, 0, \"span\", 13);\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            let tmp_3_0;\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"formGroup\", ctx.vinForm);\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngIf\", !ctx.hasValue);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.hasValue);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ((tmp_3_0 = ctx.vinForm.get(\"vin\")) == null ? null : tmp_3_0.invalid) && ((tmp_3_0 = ctx.vinForm.get(\"vin\")) == null ? null : tmp_3_0.touched));\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"disabled\", ctx.vinForm.invalid || ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n          }\n        },\n        dependencies: [i2.NgIf, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.MaxLengthValidator, i1.FormGroupDirective, i1.FormControlName],\n        encapsulation: 2\n      });\n    }\n  }\n  return VinInputComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}