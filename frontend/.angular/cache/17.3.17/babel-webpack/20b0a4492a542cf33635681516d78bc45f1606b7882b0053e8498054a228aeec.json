{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/reports.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../../components/vin-input/vin-input.component\";\nimport * as i4 from \"../../components/paywall-modal/paywall-modal.component\";\nimport * as i5 from \"../../components/report-card/report-card.component\";\nconst _c0 = [\"vinInput\"];\nfunction HomeComponent_div_49_app_report_card_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-report-card\", 35);\n    i0.ɵɵlistener(\"download\", function HomeComponent_div_49_app_report_card_7_Template_app_report_card_download_0_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onDownloadReport($event));\n    })(\"retry\", function HomeComponent_div_49_app_report_card_7_Template_app_report_card_retry_0_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.onRetryReport($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const report_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"report\", report_r4);\n  }\n}\nfunction HomeComponent_div_49_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 31)(2, \"h2\", 7);\n    i0.ɵɵtext(3, \"\\u0412\\u0430\\u0448\\u0438 \\u043E\\u0442\\u0447\\u0451\\u0442\\u044B\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 32);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 33);\n    i0.ɵɵtemplate(7, HomeComponent_div_49_app_report_card_7_Template, 1, 1, \"app-report-card\", 34);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r2.userReports.length, \" \\u043E\\u0442\\u0447\\u0451\\u0442\\u043E\\u0432\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.userReports);\n  }\n}\nexport class HomeComponent {\n  constructor(reportsService) {\n    this.reportsService = reportsService;\n    this.userReports = [];\n    this.showPaywall = false;\n    this.currentVin = '';\n    this.currentReportId = '';\n  }\n  ngOnInit() {\n    this.loadUserReports();\n  }\n  onVinSubmitted(vin) {\n    this.currentVin = vin;\n    this.reportsService.requestReport(vin).subscribe({\n      next: response => {\n        console.log('Response received:', response);\n        // Для демонстрации всегда показываем paywall\n        this.currentReportId = response.reportId;\n        this.showPaywall = true;\n        // Сбрасываем состояние загрузки\n        this.resetVinInput();\n      },\n      error: error => {\n        console.error('Ошибка запроса отчёта:', error);\n        alert('Ошибка при запросе отчёта. Попробуйте снова.');\n        // Сбрасываем состояние загрузки при ошибке\n        this.resetVinInput();\n      }\n    });\n  }\n  onDownloadReport(reportId) {\n    this.reportsService.downloadReport(reportId).subscribe({\n      next: response => {\n        window.open(response.downloadUrl, '_blank');\n      },\n      error: error => {\n        console.error('Ошибка скачивания:', error);\n        alert('Ошибка при скачивании отчёта.');\n      }\n    });\n  }\n  onRetryReport(reportId) {\n    // В реальном приложении здесь бы был запрос на повторную генерацию\n    console.log('Retry report:', reportId);\n    this.loadUserReports();\n  }\n  onClosePaywall() {\n    this.showPaywall = false;\n    this.currentVin = '';\n    this.currentReportId = '';\n  }\n  onPaymentSuccess() {\n    this.loadUserReports();\n  }\n  loadUserReports() {\n    this.reportsService.getUserReports().subscribe({\n      next: reports => {\n        this.userReports = reports;\n      },\n      error: error => {\n        console.error('Ошибка загрузки отчётов:', error);\n      }\n    });\n  }\n  resetVinInput() {\n    if (this.vinInputComponent) {\n      this.vinInputComponent.resetForm();\n    }\n  }\n  static {\n    this.ɵfac = function HomeComponent_Factory(t) {\n      return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.ReportsService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: HomeComponent,\n      selectors: [[\"app-home\"]],\n      viewQuery: function HomeComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.vinInputComponent = _t.first);\n        }\n      },\n      decls: 51,\n      vars: 4,\n      consts: [[\"vinInput\", \"\"], [1, \"min-h-screen\", \"bg-gray-50\"], [1, \"bg-white\", \"border-b\", \"border-gray-200\"], [1, \"max-w-7xl\", \"mx-auto\", \"px-4\", \"sm:px-6\", \"lg:px-8\"], [1, \"flex\", \"justify-between\", \"items-center\", \"py-6\"], [1, \"flex\", \"items-center\"], [1, \"flex-shrink-0\"], [1, \"text-2xl\", \"font-bold\", \"text-gray-900\"], [1, \"flex\", \"items-center\", \"space-x-4\"], [1, \"btn\", \"btn-outline\", \"btn-sm\"], [1, \"btn\", \"btn-primary\", \"btn-sm\"], [1, \"max-w-7xl\", \"mx-auto\", \"px-4\", \"sm:px-6\", \"lg:px-8\", \"py-12\"], [1, \"text-center\", \"mb-16\"], [1, \"text-4xl\", \"font-bold\", \"text-gray-900\", \"mb-6\"], [1, \"text-xl\", \"text-gray-600\", \"mb-8\", \"max-w-3xl\", \"mx-auto\"], [1, \"max-w-2xl\", \"mx-auto\", \"mb-16\"], [1, \"card\"], [1, \"card-body\"], [3, \"vinSubmitted\"], [1, \"grid\", \"md:grid-cols-3\", \"gap-8\", \"mb-16\"], [1, \"text-center\"], [1, \"bg-primary-50\", \"rounded-xl\", \"w-16\", \"h-16\", \"flex\", \"items-center\", \"justify-center\", \"mx-auto\", \"mb-6\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-8\", \"h-8\", \"text-primary-600\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"], [1, \"text-xl\", \"font-semibold\", \"text-gray-900\", \"mb-3\"], [1, \"text-gray-600\", \"leading-relaxed\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"], [\"class\", \"mb-16\", 4, \"ngIf\"], [3, \"close\", \"paymentSuccess\", \"isVisible\", \"vin\", \"reportId\"], [1, \"mb-16\"], [1, \"flex\", \"items-center\", \"justify-between\", \"mb-8\"], [1, \"text-sm\", \"text-gray-500\"], [1, \"grid\", \"gap-4\"], [3, \"report\", \"download\", \"retry\", 4, \"ngFor\", \"ngForOf\"], [3, \"download\", \"retry\", \"report\"]],\n      template: function HomeComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"div\", 3)(3, \"div\", 4)(4, \"div\", 5)(5, \"div\", 6)(6, \"h1\", 7);\n          i0.ɵɵtext(7, \"CarFax Web\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(8, \"div\", 8)(9, \"button\", 9);\n          i0.ɵɵtext(10, \"\\u0412\\u043E\\u0439\\u0442\\u0438\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"button\", 10);\n          i0.ɵɵtext(12, \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(13, \"div\", 11)(14, \"div\", 12)(15, \"h1\", 13);\n          i0.ɵɵtext(16, \" \\u041F\\u043E\\u043B\\u0443\\u0447\\u0438\\u0442\\u0435 \\u043F\\u043E\\u043B\\u043D\\u044B\\u0439 \\u043E\\u0442\\u0447\\u0451\\u0442 \\u043F\\u043E VIN \\u043D\\u043E\\u043C\\u0435\\u0440\\u0443 \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"p\", 14);\n          i0.ɵɵtext(18, \" \\u0423\\u0437\\u043D\\u0430\\u0439\\u0442\\u0435 \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u044E \\u0430\\u0432\\u0442\\u043E\\u043C\\u043E\\u0431\\u0438\\u043B\\u044F, \\u0430\\u0432\\u0430\\u0440\\u0438\\u0438, \\u0441\\u0435\\u0440\\u0432\\u0438\\u0441\\u043D\\u044B\\u0435 \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B \\u0438 \\u043C\\u043D\\u043E\\u0433\\u043E\\u0435 \\u0434\\u0440\\u0443\\u0433\\u043E\\u0435. \\u041F\\u0440\\u043E\\u0444\\u0435\\u0441\\u0441\\u0438\\u043E\\u043D\\u0430\\u043B\\u044C\\u043D\\u044B\\u0435 \\u043E\\u0442\\u0447\\u0451\\u0442\\u044B \\u0437\\u0430 \\u0441\\u0447\\u0438\\u0442\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043C\\u0438\\u043D\\u0443\\u0442\\u044B. \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(19, \"div\", 15)(20, \"div\", 16)(21, \"div\", 17)(22, \"app-vin-input\", 18, 0);\n          i0.ɵɵlistener(\"vinSubmitted\", function HomeComponent_Template_app_vin_input_vinSubmitted_22_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onVinSubmitted($event));\n          });\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(24, \"div\", 19)(25, \"div\", 20)(26, \"div\", 21);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(27, \"svg\", 22);\n          i0.ɵɵelement(28, \"path\", 23);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(29, \"h3\", 24);\n          i0.ɵɵtext(30, \"\\u041F\\u043E\\u043B\\u043D\\u0430\\u044F \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"p\", 25);\n          i0.ɵɵtext(32, \"\\u0410\\u0432\\u0430\\u0440\\u0438\\u0438, \\u0441\\u0435\\u0440\\u0432\\u0438\\u0441\\u043D\\u044B\\u0435 \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B, \\u043E\\u0442\\u0437\\u044B\\u0432\\u044B \\u0432\\u043B\\u0430\\u0434\\u0435\\u043B\\u044C\\u0446\\u0435\\u0432 \\u0438 \\u043C\\u043D\\u043E\\u0433\\u043E\\u0435 \\u0434\\u0440\\u0443\\u0433\\u043E\\u0435\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(33, \"div\", 20)(34, \"div\", 21);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(35, \"svg\", 22);\n          i0.ɵɵelement(36, \"path\", 26);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(37, \"h3\", 24);\n          i0.ɵɵtext(38, \"\\u0414\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0435 \\u0446\\u0435\\u043D\\u044B\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(39, \"p\", 25);\n          i0.ɵɵtext(40, \"$2 \\u0437\\u0430 \\u043E\\u0442\\u0447\\u0451\\u0442 \\u0438\\u043B\\u0438 $99 \\u0437\\u0430 100 \\u043E\\u0442\\u0447\\u0451\\u0442\\u043E\\u0432 \\u0441 \\u044D\\u043A\\u043E\\u043D\\u043E\\u043C\\u0438\\u0435\\u0439 $101\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(41, \"div\", 20)(42, \"div\", 21);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(43, \"svg\", 22);\n          i0.ɵɵelement(44, \"path\", 27);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(45, \"h3\", 24);\n          i0.ɵɵtext(46, \"\\u0411\\u0435\\u0437\\u043E\\u043F\\u0430\\u0441\\u043D\\u043E\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(47, \"p\", 25);\n          i0.ɵɵtext(48, \"\\u0417\\u0430\\u0449\\u0438\\u0449\\u0451\\u043D\\u043D\\u044B\\u0435 \\u043F\\u043B\\u0430\\u0442\\u0435\\u0436\\u0438 \\u0447\\u0435\\u0440\\u0435\\u0437 Stripe \\u0438 SSL \\u0448\\u0438\\u0444\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(49, HomeComponent_div_49_Template, 8, 2, \"div\", 28);\n          i0.ɵɵelementStart(50, \"app-paywall-modal\", 29);\n          i0.ɵɵlistener(\"close\", function HomeComponent_Template_app_paywall_modal_close_50_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onClosePaywall());\n          })(\"paymentSuccess\", function HomeComponent_Template_app_paywall_modal_paymentSuccess_50_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onPaymentSuccess());\n          });\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(49);\n          i0.ɵɵproperty(\"ngIf\", ctx.userReports.length > 0);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"isVisible\", ctx.showPaywall)(\"vin\", ctx.currentVin)(\"reportId\", ctx.currentReportId);\n        }\n      },\n      dependencies: [i2.NgForOf, i2.NgIf, i3.VinInputComponent, i4.PaywallModalComponent, i5.ReportCardComponent],\n      encapsulation: 2\n    });\n  }\n}","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵlistener","HomeComponent_div_49_app_report_card_7_Template_app_report_card_download_0_listener","$event","ɵɵrestoreView","_r2","ctx_r2","ɵɵnextContext","ɵɵresetView","onDownloadReport","HomeComponent_div_49_app_report_card_7_Template_app_report_card_retry_0_listener","onRetryReport","ɵɵelementEnd","ɵɵproperty","report_r4","ɵɵtext","ɵɵtemplate","HomeComponent_div_49_app_report_card_7_Template","ɵɵadvance","ɵɵtextInterpolate1","userReports","length","HomeComponent","constructor","reportsService","showPaywall","currentVin","currentReportId","ngOnInit","loadUserReports","onVinSubmitted","vin","requestReport","subscribe","next","response","console","log","reportId","resetVinInput","error","alert","downloadReport","window","open","downloadUrl","onClosePaywall","onPaymentSuccess","getUserReports","reports","vinInputComponent","resetForm","ɵɵdirectiveInject","i1","ReportsService","selectors","viewQuery","HomeComponent_Query","rf","ctx","HomeComponent_Template_app_vin_input_vinSubmitted_22_listener","_r1","ɵɵelement","HomeComponent_div_49_Template","HomeComponent_Template_app_paywall_modal_close_50_listener","HomeComponent_Template_app_paywall_modal_paymentSuccess_50_listener"],"sources":["/Users/test/Documents/Apps/CarFax Web/frontend/src/app/pages/home/home.component.ts"],"sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\nimport { ReportsService, Report } from '../../services/reports.service';\nimport { VinInputComponent } from '../../components/vin-input/vin-input.component';\nimport { PaywallModalComponent } from '../../components/paywall-modal/paywall-modal.component';\nimport { ReportCardComponent } from '../../components/report-card/report-card.component';\n\n@Component({\n  selector: 'app-home',\n  template: `\n    <div class=\"min-h-screen bg-gray-50\">\n      <!-- Header -->\n      <div class=\"bg-white border-b border-gray-200\">\n        <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div class=\"flex justify-between items-center py-6\">\n            <div class=\"flex items-center\">\n              <div class=\"flex-shrink-0\">\n                <h1 class=\"text-2xl font-bold text-gray-900\">CarFax Web</h1>\n              </div>\n            </div>\n            <div class=\"flex items-center space-x-4\">\n              <button class=\"btn btn-outline btn-sm\">Войти</button>\n              <button class=\"btn btn-primary btn-sm\">Регистрация</button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Main Content -->\n      <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n        <!-- Hero Section -->\n        <div class=\"text-center mb-16\">\n          <h1 class=\"text-4xl font-bold text-gray-900 mb-6\">\n            Получите полный отчёт по VIN номеру\n          </h1>\n          <p class=\"text-xl text-gray-600 mb-8 max-w-3xl mx-auto\">\n            Узнайте историю автомобиля, аварии, сервисные работы и многое другое. \n            Профессиональные отчёты за считанные минуты.\n          </p>\n        </div>\n\n        <!-- VIN Input Card -->\n        <div class=\"max-w-2xl mx-auto mb-16\">\n          <div class=\"card\">\n            <div class=\"card-body\">\n              <app-vin-input \n                (vinSubmitted)=\"onVinSubmitted($event)\"\n                #vinInput\n              ></app-vin-input>\n            </div>\n          </div>\n        </div>\n\n        <!-- Features Grid -->\n        <div class=\"grid md:grid-cols-3 gap-8 mb-16\">\n          <div class=\"text-center\">\n            <div class=\"bg-primary-50 rounded-xl w-16 h-16 flex items-center justify-center mx-auto mb-6\">\n              <svg class=\"w-8 h-8 text-primary-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\n              </svg>\n            </div>\n            <h3 class=\"text-xl font-semibold text-gray-900 mb-3\">Полная история</h3>\n            <p class=\"text-gray-600 leading-relaxed\">Аварии, сервисные работы, отзывы владельцев и многое другое</p>\n          </div>\n          \n          <div class=\"text-center\">\n            <div class=\"bg-primary-50 rounded-xl w-16 h-16 flex items-center justify-center mx-auto mb-6\">\n              <svg class=\"w-8 h-8 text-primary-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\"></path>\n              </svg>\n            </div>\n            <h3 class=\"text-xl font-semibold text-gray-900 mb-3\">Доступные цены</h3>\n            <p class=\"text-gray-600 leading-relaxed\">$2 за отчёт или $99 за 100 отчётов с экономией $101</p>\n          </div>\n          \n          <div class=\"text-center\">\n            <div class=\"bg-primary-50 rounded-xl w-16 h-16 flex items-center justify-center mx-auto mb-6\">\n              <svg class=\"w-8 h-8 text-primary-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"></path>\n              </svg>\n            </div>\n            <h3 class=\"text-xl font-semibold text-gray-900 mb-3\">Безопасно</h3>\n            <p class=\"text-gray-600 leading-relaxed\">Защищённые платежи через Stripe и SSL шифрование</p>\n          </div>\n        </div>\n\n        <!-- User Reports Section -->\n        <div *ngIf=\"userReports.length > 0\" class=\"mb-16\">\n          <div class=\"flex items-center justify-between mb-8\">\n            <h2 class=\"text-2xl font-bold text-gray-900\">Ваши отчёты</h2>\n            <span class=\"text-sm text-gray-500\">{{ userReports.length }} отчётов</span>\n          </div>\n          <div class=\"grid gap-4\">\n            <app-report-card \n              *ngFor=\"let report of userReports\"\n              [report]=\"report\"\n              (download)=\"onDownloadReport($event)\"\n              (retry)=\"onRetryReport($event)\"\n            ></app-report-card>\n          </div>\n        </div>\n\n        <!-- Paywall Modal -->\n        <app-paywall-modal\n          [isVisible]=\"showPaywall\"\n          [vin]=\"currentVin\"\n          [reportId]=\"currentReportId\"\n          (close)=\"onClosePaywall()\"\n          (paymentSuccess)=\"onPaymentSuccess()\"\n        ></app-paywall-modal>\n      </div>\n    </div>\n  `,\n  styles: []\n})\nexport class HomeComponent implements OnInit {\n  @ViewChild('vinInput') vinInputComponent!: VinInputComponent;\n  \n  userReports: Report[] = [];\n  showPaywall = false;\n  currentVin = '';\n  currentReportId = '';\n\n  constructor(private reportsService: ReportsService) {}\n\n  ngOnInit(): void {\n    this.loadUserReports();\n  }\n\n  onVinSubmitted(vin: string): void {\n    this.currentVin = vin;\n    this.reportsService.requestReport(vin).subscribe({\n      next: (response) => {\n        console.log('Response received:', response);\n        // Для демонстрации всегда показываем paywall\n        this.currentReportId = response.reportId;\n        this.showPaywall = true;\n        // Сбрасываем состояние загрузки\n        this.resetVinInput();\n      },\n      error: (error) => {\n        console.error('Ошибка запроса отчёта:', error);\n        alert('Ошибка при запросе отчёта. Попробуйте снова.');\n        // Сбрасываем состояние загрузки при ошибке\n        this.resetVinInput();\n      }\n    });\n  }\n\n  onDownloadReport(reportId: string): void {\n    this.reportsService.downloadReport(reportId).subscribe({\n      next: (response) => {\n        window.open(response.downloadUrl, '_blank');\n      },\n      error: (error) => {\n        console.error('Ошибка скачивания:', error);\n        alert('Ошибка при скачивании отчёта.');\n      }\n    });\n  }\n\n  onRetryReport(reportId: string): void {\n    // В реальном приложении здесь бы был запрос на повторную генерацию\n    console.log('Retry report:', reportId);\n    this.loadUserReports();\n  }\n\n  onClosePaywall(): void {\n    this.showPaywall = false;\n    this.currentVin = '';\n    this.currentReportId = '';\n  }\n\n  onPaymentSuccess(): void {\n    this.loadUserReports();\n  }\n\n  private loadUserReports(): void {\n    this.reportsService.getUserReports().subscribe({\n      next: (reports) => {\n        this.userReports = reports;\n      },\n      error: (error) => {\n        console.error('Ошибка загрузки отчётов:', error);\n      }\n    });\n  }\n\n  private resetVinInput(): void {\n    if (this.vinInputComponent) {\n      this.vinInputComponent.resetForm();\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}